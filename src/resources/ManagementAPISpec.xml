<?xml version="1.0" encoding="UTF-8"?>
<book version="5.0" xmlns="http://docbook.org/ns/docbook"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:svg="http://www.w3.org/2000/svg"
      xmlns:m="http://www.w3.org/1998/Math/MathML"
      xmlns:html="http://www.w3.org/1999/xhtml"
      xmlns:db="http://docbook.org/ns/docbook">
    <title>Load Balancing Service Management API Specification</title>
    <info>
        <author>
            <personname>
                          <firstname/>
                   <surname/>
            </personname>
            <affiliation>
                <orgname>Rackspace Cloud</orgname>
            </affiliation>
        </author>
        <copyright>
            <year>2010</year>
            <holder>Rackspace Hosting, Inc.</holder>
        </copyright>
        <releaseinfo/>

        <productname>Cloud Sites: LBaaS</productname>
        <pubdate>11/11/10</pubdate>
        <abstract>
            <para/>
        </abstract>
    </info>
    <chapter>
        <title>Management API Operations</title>
        <section>
            <title>Listing, Creating, Updating, and Deleting Load Balancing Clusters</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/clusters</td>
                        <td>Retrieve a list of all clusters</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/clusters/clusterId</td>
                        <td>Retrieve a cluster by id</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/clusters</td>
                        <td>Create a new cluster</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/clusters/clusterId</td>
                        <td>Upate the name, description, username, or password of a cluster</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/clusters/clusterId</td>
                        <td>Remove a cluster</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                <emphasis>Normal Response Code(s):</emphasis> 200
            </para>
            <para>
                <emphasis>Error Response Code(s):</emphasis> loadBalancerManagementFault (400, 500), serviceUnavailable (503), unauthorized (401), badRequest (400), overLimit (413)
            </para>
            <section>
                <title>Description</title>
                <para>
                    The cluster operations allow for listing and manipulating clusters.  In order to remove a cluster, it may not have any host machines or virtual IP's associated with it. To create a new cluster, the caller must supply their username, password, cluster name, cluster description and datacenter attributes within the request.
                </para>
                <para>
                    The GET response contains numerous attributes (numberOfLoadBalancingConfigurations, numberOfUniqueCustomers, numberOfHostMachines, and utilization) that are generated and immutable.  These attributes are calculated based on configurations associated with this cluster.
                </para>
            </section>
            <section>
                <title>Sample XML Response (/clusters)</title>
                <literallayout class="monospaced">
<![CDATA[<clusters xmlns="http://docs.openstack.org/loadbalancers/api/mgmt/v1.0">
   <cluster
      id="1"
      name="Cluster Alpha"
      description="The best cluster, ever."
      datacenter="DFW"
      numberOfLoadBalancingConfigurations="410"
      numberOfUniqueCustomers="348"
      numberOfHostMachines="8"
      utilization="59%" />
   <cluster
      id="2"
      name="Cluster Beta"
      description="The second best cluster, ever."
      datacenter="ORD"
      numberOfLoadBalancingConfigurations="580"
      numberOfUniqueCustomers="490"
      numberOfHostMachines="8"
      utilization="76%" />
</clusters>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/clusters)</title>
                <literallayout class="monospaced">
<![CDATA[{"clusters": {
        "cluster": [
            {
                "id": "1",
                "name": "Cluster Alpha",
                "description": "The best cluster, ever.",
                "dataCenter": "DFW",
                "numberOfLoadBalancingConfigurations": "410",
                "numberOfUniqueCustomers": "348",
                "numberOfHostMachines": "8",
                "utilization": "59%"
            },
            {
                "id": "1",
                "name": "Cluster Beta",
                "description": "The second best cluster, ever.",
                "dataCenter": "DFW",
                "numberOfLoadBalancingConfigurations": "580",
                "numberOfUniqueCustomers": "490",
                "numberOfHostMachines": "8",
                "utilization": "76%"
            }
        ]
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Response (/clusters/clusterId)</title>
                <literallayout class="monospaced">
<![CDATA[<cluster
      id="1"
      name="Cluster Alpha"
      description="The best cluster, ever."
      datacenter="DFW"
      numberOfLoadBalancingConfigurations="410"
      numberOfUniqueCustomers="348"
      numberOfHostMachines="8"
      utilization="59%" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/clusters/clusterId)</title>
                <literallayout class="monospaced">
<![CDATA[{"cluster": {
        "id": "1",
        "name": "Cluster Alpha",
        "description": "The best cluster, ever.",
        "dataCenter": "DFW",
        "numberOfLoadBalancingConfigurations": "410",
        "numberOfUniqueCustomers": "348",
        "numberOfHostMachines": "8",
        "utilization": "59%"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (POST) (/clusters)</title>
                <literallayout class="monospaced">
<![CDATA[<cluster
       xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
       name="Cluster Gamma"
       description="The third best cluster, ever."
       dataCenter="DFW"
       username="my username"
       password="my password"/>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON POST Request (/clusters)</title>
                <literallayout class="monospaced">
<![CDATA[{"cluster": {
        "name": "Cluster Gamma",
        "description": "The third best cluster, ever.",
        "datacenter": "DFW",
        "username" : "my username",
        "password" : "my password"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML PUT Request (/clusters/clusterid)</title>
                <literallayout class="monospaced">
<![CDATA[<cluster
       xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
       name="Cluster Delta"
       description="The fourth best cluster, ever."
       username="aaa"/>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON PUT Request (/clusters/clusterid)</title>
                <literallayout class="monospaced">
<![CDATA[{"cluster": {
        "name": "Cluster Delta",
        "description": "The fourth best cluster, ever.",
        "username": "aaa"
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Listing, Creating, Updating, and Deleting Load Balancing Host Machines</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/hosts</td>
                        <td>Retrieve a list of all hosts within the region</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/clusters/clusterId/hosts</td>
                        <td>Retrieve a list of all hosts belonging to a cluster</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/hosts</td>
                        <td>Create a new load balancing host</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId</td>
                        <td>Update the mutable attributes of a load balancing host</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/hosts/hostId</td>
                        <td>Remove a load balancing host</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/clusters/clusterId/endpoint</td>
                        <td>Retrieves the host that is currently the active SOAP endpoint</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/endpoint/enable</td>
                        <td>Enable this host's SOAP endpoint (Warning: can be overwritten by pollendpoints call)</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/endpoint/disable</td>
                        <td>Disable this host's SOAP endpoint (Warning: can be overwritten by pollendpoints call)</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/clusters/pollendpoints</td>
                        <td>tests all endpoints and sets soap_endpoint_active if endpoint works</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    The host operations allow for retrieval of host configuration data and statistics as well as the ability to add, manipulate or delete load balancing hosts.
                </para>
                <section>
                    <title>Creating a New Host</title>
                    <para>
                        When creating a new host, the caller must supply the following attributes:
                    </para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>
                                name
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                clusterid
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                coreDeviceId
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                zone
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                maxConcurrentConnections
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                managementIpAddress
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                managementSoapInterface
                            </para>
                        </listitem>
                    </itemizedlist>
                    <para>
                        Additionally, the system will attempt to validate that it can properly access the host based on the managementSoapInterface, managementSoapUsername, and managementSoapPassword. The system should automatically apply a BURN_IN status to all newly added host machines.
                    </para>
                    <note>
                        For an example of how a new host is created, see the "Sample XML Post Request" below.
                    </note>
                </section>
                <section>
                    <title>Mutable Attributes</title>
                    <para>
                        The following list of attributes are mutable via the PUT HTTP operation:
                    </para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>
                                name
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                coreDeviceId
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                status (Active, Active Target, Maintenance, Failover
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                maxConcurrentConnections
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                managementIpAddress
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                managementSoapInterface
                            </para>
                        </listitem>
                    </itemizedlist>
                    <para>
                        The GET response contains numerous attributes (utilization, numberOfLoadBalancingConfigurations, and numberOfUniqueCustomers) that are generated based on state data and are immutable. These attributes are calculated based on configurations associated with this host.
                    </para>
                </section>
            </section>
            <section>
                <title>Sample XML Response (/hosts) (/clusters/clusterId/hosts)</title>
                <literallayout class="monospaced">
<![CDATA[<hosts xmlns="http://docs.openstack.org/loadbalancers/api/mgmt/v1.0">
    <host
            id="1"
            name="host1"
            clusterId="1"
            coreDeviceId="14410"
            zone="A"
            status="ACTIVE_TARGET"
            maxConcurrentConnections="150000"
            managementIpAddress="10.1.1.1"
            managementSoapInterface="http://10.1.1.1:9090/soap"
            utilization="60%"
            numberOfLoadBalancingConfigurations="414"
            numberOfUniqueCustomers="141"
            soapEndpointActive="true"/>
    <host
            id="2"
            name="host2"
            clusterId="1"
            coreDeviceId="15510"
            zone="B"
            status="ACTIVE_TARGET"
            maxConcurrentConnections="150000"
            managementIpAddress="10.1.1.2"
            managementSoapInterface="http://10.1.1.2:9090/soap"
            utilization="59%"
            numberOfLoadBalancingConfigurations="520"
            numberOfUniqueCustomers="515"
            soapEndpointActive="true/>
</hosts>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/hosts) (/clusters/clusterId/hosts)</title>
                <literallayout class="monospaced">
<![CDATA[{"hosts": {
        "host": [
            {
                "id": "1",
                "name": "host1",
                "clusterId": "1",
                "coreDeviceId": "14410",
                "zone": "A",
                "status": "ACTIVE_TARGET",
                "maxConcurrentConnections": "150000",
                "managementIpAddress": "10.1.1.1",
                "managementSoapInterface": "http://10.1.1.1:9090/soap",
                "utilization": "60%",
                "numberOfLoadBalancingConfiguraions": "414",
                "numberOfUniqueCustomers": "141",
                "soapEndpointActive": "true"
            },
            {
                "id": "2",
                "name": "1",
                "clusterId": "1",
                "coreDeviceId": "15510-44140",
                "zone": "B",
                "status": "ACTIVE_TARGET",
                "maxConcurrentConnections": "150000",
                "managementIpAddress": "10.1.1.2",
                "managementSoapInterface": "httpd://10.1.1.2:9090/soap",
                "utilization": "59%",
                "numberOfLoadBalancingConfigurations": "520",
                "numberOfUniqueCustomers": "515",
                "soapEndpointActive": "true"
            }
        ]
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (POST) (/hosts)</title>
                <literallayout class="monospaced">
<![CDATA[<host xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
        clusterId="1"
        coreDeviceId="SomeCoreDevice"
        managementIp="12.34.56.78"
        managementSoapInterface="https://SomeSoapNode.com:9090"
        maxConcurrentConnections="5"
        name="someName"
        status="BURN_IN"
        trafficManagerName="zues01.blah.blah"
        type="FAILOVER"
        zone="B"
        soapEndpointActive="true" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (POST) (/hosts)</title>
                <literallayout class="monospaced">
<![CDATA[{"host": {
        "status": "BURN_IN",
        "name": "someName",
        "zone": "B",
        "type": "FAILOVER",
        "managementIp": "12.34.56.78",
        "trafficManagerName": "zues01.blah.blah",
        "clusterId": 1,
        "maxConcurrentConnections": 5,
        "coreDeviceId": "SomeCoreDevice",
        "managementSoapInterface": "https://SomeSoapNode.com:9090",
        "soapEndpointActive": "true"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML PUT Request (/hosts/hostid)</title>
                <literallayout class="monospaced">
<![CDATA[<host xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
        name="my-next-host"
        coreDeviceId="144410-44001"
        status="BURN_IN"
        maxConcurrentConnections="150000"
        managementIpAddress="10.1.1.2"
        managementSoapInterfac="http://10.1.1.2:9090/soap"
        soapEndpointActive="true" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON PUT Request (/hosts/hostid)</title>
                <literallayout class="monospaced">
<![CDATA[{"host": {
        "name": "my-next-host",
        "coreDeviceId": "144410-44001",
        "status": "BURN_IN",
        "maxConcurrentConnections": "150000",
        "managementIpAddress": "10.1.1.2",
        "managementSoapInterface": "http://10.1.1.2:9090/soap",
        "soapEndpointActive": "true"
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Virtual IP Management</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/virtualips</td>
                        <td>Retrieve a list of all virtual IPs associated to the region</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/clusters/clusterId/virtualips</td>
                        <td>Retrieve a list of all virutal IPs associate to a cluster</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/virtualips/virtualIpId/loadbalancers</td>
                        <td>Retrieve a list of load balancers associated with this virtual IP</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/loadbalancers/loadBalancerId/virtualips</td>
                        <td>Retrieve a list of all virtual IPs associated with a load balancer</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/clusters/clusterId/virtualips</td>
                        <td>Assign one-or-more additional virtual IPs to a cluster</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/clusters/clusterId/virtualipblocks</td>
                        <td>Assign a set of IP blocks to the cluster</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/clusters/clusterId/virtualips/virtualIpId</td>
                        <td>Remove the specified virtual IP from the cluster</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    The virtual IP operations allow the caller to view, create, and remove virtual IPs from an environment.  Virtual IPs are automatically assigned to every newly created load balancer and can be added on-demand by a support or service administrator with proper justification.  Management of the service requires blocks of IP addresses to be allocated from time-to-time to ensure availability for customers.
                </para>
                <para>
                    In order to assign a virtual IP to the environment via the POST operation, the caller must supply the address, and type attributes as part of the virtualip element.  A sample POST request can be found below.
                </para>
                <note>
                    In the event a virtual IP must be removed from the cluster, the DELETE operation can be used; however, to delete a virtual IP it must not have a load balancer associated to it.
                </note>
                <note>
                    To add a single or multiple specific virtual ip's simply specify the first and lastIp fields identically(not a range).
                </note>
            </section>
            <section>
                <title>Sample XML Response (/virtualips) (/clusters/clusterId/virtualips)</title>
                <literallayout class="monospaced">
<![CDATA[<virtualips>
   <virtualip id="411"
      loadBalancerId="1"
      clusterId="1"
      address="98.128.33.1"
      type="PUBLIC" />
   <virtualip
      id="501"
      clusterId="1"
      address="10.41.133.4"
      type="SERVICENET" />
</virtualips>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/virtualips) (/clusters/clusterId/virtualips)</title>
                <literallayout class="monospaced">
<![CDATA[{"virtualips": {
        "virtualip": [
            {
                "id": "411",
                "loadBalancerId": "1",
                "clusterId": "1",
                "address": "98.128.33.1",
                "type": "PUBLIC"
            },
            {
                "id": "501",
                "loadBalancerId": "1",
                "clusterId": "1",
                "address": "10.41.133.4",
                "type": "SERVICENET"
            }
        ]
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML POST Request (/clusters/clusterId/virtualips)</title>
                <literallayout class="monospaced">
<![CDATA[<virtualips>
   <virtualip
      address="98.128.33.4"
      type="PUBLIC" />
   <virtualip
      address="98.128.33.5"
      type="PUBLIC" />
</virtualips>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (POST) (/clusters/clusterId/virtualipsblocks)</title>
                <literallayout class="monospaced">
<![CDATA[<virtualIpBlocks type="PUBLIC"
       xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
       xmlns:ns2="http://docs.openstack.org/loadbalancers/api/v1.0">
	<ns2:virtualIpBlock firstIp="10.0.0.5" lastIp="10.0.0.5"/>
	<ns2:virtualIpBlock firstIp="172.16.0.64" lastIp="172.16.0.64"/>
</virtualIpBlocks>
]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (POST) (/clusters/clusterId/virtualips)</title>
                <literallayout class="monospaced">
<![CDATA[{"virtualIpBlocks": [
        {
            "firstIp": "10.0.0.5",
            "lastIp": "10.0.0.5"
        },
        {
            "firstIp": "172.16.0.64",
            "lastIp": "172.16.0.64"
        },
        {
            "firstIp": "192.168.0.3",
            "lastIp": "192.168.0.3"
        }
    ],
    "type": "SERVICENET"
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Rate Limiting a Load Balancer</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/loadbalancers/loadBalancerId/ratelimit</td>
                        <td>Retrieve the rate limit information for a specified load balancer</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/loadbalancers/loadBalancerId/ratelimit</td>
                        <td>Impose a new rate limit on the specified load balancer</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/loadbalancers/loadBalancerId/ratelimit</td>
                        <td>Modify the expiration time and/or ticket associated with the rate limit</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/loadbalancers/loadBalancerId/ratelimit</td>
                        <td>Immediately remove the defined rate limit</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/loadbalancers/loadBalancerId/ratelimit/removeoldlimits</td>
                        <td>Immediately remove expired limits</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    Rate limiting allows a service administrator to artificially limit the number of requests that are permitted to transit a given load balancer.  This action can be taken when a particular load balancer is servicing questionable traffic, the victim of a DDoS, etc.  To define a rate limit, the caller must supply a ticket id, maximum number of connections per second, and an expiration time.
                </para>
                <para>
                    Additionally, rate limit information is returned as part of the "extended details of a load balancer", which is documented below.
                </para>
            </section>
            <section>
                <title>Sample XML Response (/loadbalancers/loadBalancerId/ratelimit)</title>
                <literallayout class="monospaced">
<![CDATA[<rateLimit
   ticketId="44410"
   expirationTime="2010-10-17T00:00:00-05:00"
   maxRequestsPerSecond="150" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/loadbalancers/loadBalancerId/ratelimit)</title>
                <literallayout class="monospaced">
<![CDATA[{"rateLimit": {
        "ticketId": "44410",
        "expirationTime": "2010-10-17 00:00:00",
        "maxRequestPerSecond": "150"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (POST) (/loadbalancers/loadBalancerId/ratelimit)</title>
                <literallayout class="monospaced">
<![CDATA[<rateLimit xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
   ticketId="44410"
   expirationTime="2010-10-17T00:00:00"
   maxRequestsPerSecond="150" />
]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (POST) (/loadbalancers/loadBalancerId/ratelimit)</title>
                <literallayout class="monospaced">
<![CDATA[{"rateLimit": {
        "ticketId": "44411",
        "expirationTime": "2010-10-17 00:00:00",
        "maxRequestsPerSecond": "150"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (PUT) (/loadbalancers/loadBalancerId/ratelimit)</title>
                <literallayout class="monospaced">
<![CDATA[<rateLimit xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
   ticketId="44411"
   expirationTime="2010-10-18 00:00:00"
   maxRequestsPerSecond="150" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (PUT) (/loadbalancers/loadBalancerId/ratelimit)</title>
                <literallayout class="monospaced">
<![CDATA[{"rateLimit": {
        "ticketId": "44411",
        "expirationTime": "2010-10-17 00:00:00",
        "maxRequestsPerSecond": "150"
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Moving Load Balancers Between Host Machines / Adjusting Stickiness of Load Balancer Hosts</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/loadbalancers/loadBalancerId/sticky</td>
                        <td>Make the specified load balancer sticky</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/loadbalancers/loadBalancerid/sticky</td>
                        <td>Turn off the "sticky" flag on the specified load balancer</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>loadbalancers/loadBalancerId/hosts</td>
                        <td>Get the host assignment(s) for a specified load balancer</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/loadbalancers/loadBalancerId/hosts</td>
                        <td>Update the host assignment(s) for a specified load balancer</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/loadbalancers/reassignhosts</td>
                        <td>update the host assignment(s) for a list of load balancers</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    Service administrators may re-assign a load balancer to a different host machine within the same cluster.  This action can be taken if capacity warrants it or if a particular configuration needs to be isolated from others within the environment.  Both active and failover hosts may be changed.
                </para>
                <para>
                    Additionally, this operation allows for a service administrator to define a load balancer's host configurations as being "sticky", which will prohibit the system from automatically moving this configuration between hosts to balance the host performance.
                </para>
                <para>
                    A load balancer that is defined as being ACTIVE on multiple hosts will allow the load balancer host machines to service traffic for a single VIP across multiple systems.  This is an advanced feature that should be used cautiously as it can potentially amplify DDoS and other types of malicious traffic.
                </para>
            </section>
            <section>
                <title>Sample XML Request (GET) (/loadbalancers/loadBalancerId/host)</title>
                <literallayout class="monospaced">
<![CDATA[<host xmlns="http://docs.rackspacecloud.com/loadbalancers/api/management/v1.0"
        id="1"
        name="host1"
        clusterId="1"
        coreDeviceId="10"
        maxConcurrentConnections="1500"
        managementIp="10.2.2.3"
        trafficManagerName="ztm-n01.dev.lbaas.rackspace.com"
        managementSoapInterface="https://173.203.239.70:9090/soap" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (GET) (/loadbalancers/loadBalancerId/host)</title>
                <literallayout class="monospaced">
<![CDATA[{"host": [
        {
            "id": 1,
            "name": "host1",
            "clusterId": 1,
            "coreDeviceId": 10,
            "maxConcurrentConnections": 1500,
            "managementIp": "10.2.2.3",
            "trafficManagerName": "ztm-n01.dev.lbaas.rackspace.com",
            "managementSoapInterface": "https://173.203.239.70:9090/soap"
        }
    ]
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (PUT) (/loadbalancers/reassignhosts)</title>
                <literallayout class="monospaced">
<![CDATA[<loadBalancers xmlns="http://docs.rackspacecloud.com/loadbalancers/api/management/v1.0">
   <loadBalancer id="49" >
     <host id="2"/>
   </loadBalancer>
</loadBalancers>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (PUT) (/loadbalancers/reassignhosts)</title>
                <literallayout class="monospaced">
<![CDATA[{"loadBalancers": {
        {"loadbalancer": {
                "id": 49,
                "host": {
                    "id": 2
                }
            }
        }
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Response (/loadbalancers/reassignhosts)</title>
                <literallayout class="monospaced">
<![CDATA[<loadBalancers xmlns="http://docs.rackspacecloud.com/loadbalancers/api/management/v1.0">
   <loadBalancer id="1" />
</loadBalancers>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/loadbalancers/reassignhosts)</title>
                <literallayout class="monospaced">
<![CDATA[{"loadbalancers": {
        "loadbalancer": [
            {
                "id": "1"
            },
            {
                "id": "2"
            }
        ]
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (PUT) (/loadbalancers/loadBalancerId/hosts)</title>
                <literallayout class="monospaced">
<![CDATA[{"loadbalancers": {
        "loadbalancer": [
            {
                "id": "1"
            }
          ],
           "host": [
           {
             "id": "2"
           }
        ]
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Host machine Configuration Backup &amp; Restoration</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Levels</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/hosts/backups</td>
                        <td>View a list of available backups for all host machines</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/hosts/hostId/backups</td>
                        <td>View a list of available backups for a specified host machine</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/hosts/hostId/subnetmappings</td>
                        <td>View the list of subnet mappings for this host</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/subnetmappings</td>
                        <td>Add subnet mappings on this host</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/host/hostId/subnetmappings/delete</td>
                        <td>Delete the specified subnet mappings on this host</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/activate</td>
                        <td>Activate Host Machine</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/inactive</td>
                        <td>Deactivate Host Machine</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/backups</td>
                        <td>Create a new backup of the host configuration</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/hosts/hostId/backups/backupId</td>
                        <td>Purge a backup with the specified backup ID</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/hosts/hostId/backups/backupId/restore</td>
                        <td>Restore the specified backup to the host machine</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    The host backup and restoration tools allow for service administrators to take periodic backups of the current state of the configuration on any given host machine.  These functions allow the caller to view, create new backups, purge backups, and restore any available configuration.
                </para>
            </section>
            <section>
                <title>Non mutable Parameters:</title>
                <para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>
                                backupTime
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                hostId
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                id
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>
                    Callers are not required to supply request bodies for the PUT (Restore Backup) operations.
                </para>
            </section>
            <section>
                <title>Creating a New Backup</title>
                <para>
                    When creating a new backup, the caller must supply the following attributes:
                </para>
                <para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>name</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </section>
            <section>
                <title>Sample XML Response (/hosts/backups)</title>
                <literallayout class="monospaced">
<![CDATA[<backups>
   <backup
      id="1"
      name="NightlyBackUp"
      backupTime="2010-10-17 00:00:00"
      hostId="1234" />
</backups>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/hosts/backups)</title>
                <literallayout class="monospaced">
<![CDATA[{"backups": {
        "backup": {
            "id": "1",
            "name": "NightlyBackUp",
            "backupTime": "2010-10-17 00:00:00"
            "hostId": "1234"
        }
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Response (hosts/hostId/backups)</title>
                <literallayout class="monospaced">
<![CDATA[<backups>
   <backup
      id="1"
      name="great backup"
      backupTime="2010-10-17 00:00:00" />
</backups>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (hosts/hostId/backups)</title>
                <literallayout class="monospaced">
<![CDATA[{"backups": {
        "backup": {
            "id": "1",
            "name": "NightlyBackUp",
            "backupTime": "2010-10-17 00:00:00"
        }
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (POST) (/hosts/hostId/backups)</title>
                <literallayout class="monospaced">
<![CDATA[<backup
   xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
   name="NightlyBackUp" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (POST) (/hosts/hostId/backups)</title>
                <literallayout class="monospaced">
<![CDATA[{"backup": {
        "name": "NightlyBackup"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Response (GET) (/hosts/hostId/subnetmappings)</title>
                <literallayout class="monospaced">
<![CDATA[<?xml version="1.0" ?>
<ns2:hostssubnet xmlns="http://docs.rackspacecloud.com/loadbalancers/api/v1.0" xmlns:ns2="http://docs.rackspacecloud.com/loadbalancers/api/management/v1.0">
    <ns2:hostsubnet name="api-zxtm-n01.stage.dfw1.stabletransit.com">
        <ns2:netInterface name="eth0">
            <ns2:cidr block="10.69.1.0/24"/>
            <ns2:cidr block="10.69.0.0/24"/>
        </ns2:netInterface>
    </ns2:hostsubnet>
</ns2:hostssubnet>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request (PUT) (/hosts/hostId/subnetmappings)</title>
                <literallayout class="monospaced">
<![CDATA[<?xml version="1.0" ?>
<ns2:hostssubnet xmlns="http://docs.rackspacecloud.com/loadbalancers/api/v1.0" xmlns:ns2="http://docs.rackspacecloud.com/loadbalancers/api/management/v1.0">
       <ns2:hostsubnet name="n01.zeus.something">
           <ns2:netInterface name="eth1">
	            <ns2:cidr block="192.168.0.0/16"/>
           </ns2:netInterface>
       </ns2:hostsubnet>
</ns2:hostssubnet>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Request (PUT) (/hosts/hostId/subnetmappings)</title>
                <literallayout class="monospaced">
<![CDATA[{
    "hostsubnets": [
        {
            "netInterfaces": [
                {
                    "cidrs": [
                        {
                          "block": "192.168.0.0/16"
                        }
                    ],
                    "name": "eth1"
                }
            ],
            "name": "n01.zeus.something"
        }
    ]
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Customer List by Host/Cluster</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>POST</td>
                        <td>/hosts/customers</td>
                        <td>Generate a customer list by host</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/clusters/customers</td>
                        <td>Generate a customer list by cluster</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    The generated customer list allows external services, which contain customer contact information, to query the load balancing service to determine the breakdown of customers at either the cluster or host level.
                </para>
            </section>
            <section>
                <title>Sample XML Request ByName (/hosts/customers) (/clusters/customers)</title>
                <literallayout class="monospaced">
<![CDATA[<byIdOrName
            xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
            xmlns:ns2="http://docs.openstack.org/loadbalancers/api/v1.0"
            name="newhost" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Request ById (/hosts/customers) (/clusters/customers)</title>
                <literallayout class="monospaced">
<![CDATA[<byIdOrName
            xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
            xmlns:ns2="http://docs.openstack.org/loadbalancers/api/v1.0"
            id="2" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML Response (/hosts/customers) (/clusters/customers)</title>
                <literallayout class="monospaced">
<![CDATA[<?xml version="1.0" ?>
<customerList xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0" xmlns:ns2="http://docs.openstack.org/loadbalancers/api/v1.0">
	<customer accountId="666">
		<loadBalancer id="52" name="LB.4707"/>
		<loadBalancer id="53" name="LB.3133"/>
		<loadBalancer id="54" name="LB.6882"/>
		<loadBalancer id="55" name="LB.5095"/>
		<loadBalancer id="56" name="LB.3135"/>
		<loadBalancer id="57" name="LB.3399"/>
		<loadBalancer id="58" name="LB.1341"/>
		<loadBalancer id="59" name="LB.2750"/>
		<loadBalancer id="60" name="LB.1980"/>
		<loadBalancer id="61" name="LB.1237"/>
	</customer>
	<customer accountId="999">
		<loadBalancer id="47" name="LB.7090"/>
		<loadBalancer id="48" name="LB.3226"/>
		<loadBalancer id="49" name="LB.912"/>
		<loadBalancer id="50" name="LB.6697"/>
		<loadBalancer id="51" name="LB.6897"/>
	</customer>
	<customer accountId="354934">
		<loadBalancer id="45" name="LB.5001">
			<ns2:nodes>
				<ns2:node id="202" ip="21.248.193.163"/>
				<ns2:node id="204" ip="142.120.171.164"/>
				<ns2:node id="203" ip="231.162.141.253"/>
				<ns2:node id="205" ip="15.162.23.37"/>
				<ns2:node id="201" ip="182.254.203.171"/>
			</ns2:nodes>
		</loadBalancer>
		<loadBalancer id="46" name="LB.9540">
			<ns2:nodes>
				<ns2:node id="209" ip="200.47.43.240"/>
				<ns2:node id="207" ip="168.80.57.76"/>
				<ns2:node id="206" ip="229.220.95.81"/>
				<ns2:node id="208" ip="114.48.233.151"/>
				<ns2:node id="210" ip="228.221.170.235"/>
			</ns2:nodes>
		</loadBalancer>
	</customer>
</customerList>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/hosts/hostId/customers) (/clusters/clusterId/customers)</title>
                <literallayout class="monospaced">
<![CDATA[{"customerlist": {
        "customer": {
            "id": "327957",
            "loadbalancer": [
                {
                    "id": "1",
                    "name": "lb-1"
                },
                {
                    "id": "2",
                    "name": "lb-2"
                }
            ]
        }
    }
}]]>
                </literallayout>
            </section>
        </section>
    </chapter>
    <chapter>
        <title>Capacity and Availability Reports</title>
        <section>
            <title>Load Balancing Host Capacity Planning Board</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/hosts/capacityreport</td>
                        <td>Generate a capacity planning report for all load balancing hosts</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/hosts/hostId/capacityreport</td>
                        <td>Generate a capacity planning report for a specified load balancing host</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    The load balancing host capacity reports provide insight into the available capacity of a given host machine.  It also supplies an estimated runway of available capacity based on historical provisioning activity (activity taking place over a period of one week).
                </para>
            </section>
            <section>
                <title>Sample XML Response (/hosts/capacityreport) (/hosts/hostId/capacityreport)</title>
                <literallayout class="monospaced">
<![CDATA[<hostcapacityreports>
    <hostcapacityreport
                hostId="1"
                hostName="The Best Host Ever"
                totalConcurrentConnectionCapacity="150000"
                availableConcurrentConnections="100000"
                allocatedConcurrentConnections="50000"
                allocatedConcurrentConnectionsToday="14000"
                allocatedConcurrentConnectionsInPastSevenDays="25000"
                remainingDaysOfCapacity="9.55" />
</hostcapacityreports>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/hosts/capacityreport) (/hosts/hostId/capacityreport)</title>
                <literallayout class="monospaced">
<![CDATA[{"hostcapacityreports": {
        "hostcapacityreport": {
            "hostId": "1",
            "hostName": "The Best Host Ever",
            "totalConcurrentConnectionCapacity": "150000",
            "availableConcurrentConnections": "100000",
            "allocatedConcurrentConnections": "50000",
            "allocatedConcurrentConnectionsToday": "14000",
            "remainingDaysOfCapacity": "9.55"
        }
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Load Balancing Cluster Virtual IP Availability Report</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/virtualips/availabilityreport</td>
                        <td>Generate an availability report for all virtual IPs associated to any cluster.</td>
                        <td>Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/clusters/clusterId/virtualips/availabilityreport</td>
                        <td>Generate an availability report for all virtual IPs associated to the specific cluster</td>
                        <td>Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    The virtual IP availability report provides insight into the availability of both public and ServiceNet IP addresses that are provisioned to a cluster.  It also supplies an estimated runway of available capacity based on historical provisioning activity (activity taking place over a period of one week).
                </para>
            </section>
            <section>
                <title>Sample XML Response (/virtualips/availabilityreport) (/cluster/clusterId/availabilityreport)</title>
                <literallayout>
<![CDATA[<virtualipavailabilityreports>
   <virtualipavailabilityreport
              clusterId="1"
              clusterName="My Little Cluster"
              totalPublicIpAddresses="254"
              totalServiceNetAddresses="254"
              freeAndClearPublicIpAddresses="128"
              freeAndClearServiceNetIpAddresses="128"
              publicIpAddressesInHolding="14"
              serviceNetIpAddressesInHolding="21"
              publicIpAddressesAllocatedToday="15"
              serviceNetIpAddressesAllocatedToday="4"
              allocatedPublicIpAddressesInLastSevenDays="45"
              allocatedServiceNetIpAddressesInLastSevenDays="15"
              remainingDaysOfPublicIpAddresses="50.11"
              remainingDaysOfServiceNetIpAddresses="14.41" />
</virtualipavailabilityreports>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/virtualips/availabilityreport) (/cluster/clusterId/availabilityreport)</title>
                <literallayout class="monospaced">
<![CDATA[{"virtualipavailabilityreport": {
        "clusterId": "1",
        "clusterName": "My Little Cluster",
        "totalPublicIpAddresses": "254",
        "totalServiceNetAddresses": "254",
        "freeAndClearPublicIpAddresses": "128",
        "freeAndClearServiceNetIpAddresses": "128",
        "publicIpAddressesInHolding": "14",
        "serviceNetIpAddressesInHolding": "21",
        "publicIpAddressesAllocatedToday": "15",
        "serviceNetIpAddressesAllocatedToday": "4",
        "allocatedPublicIpAddressesInLastSevenDays": "45",
        "allocatedServiceNetIpAddressesInLastSevenDays": "15",
        "remainingDaysOfPublicIpAddresses": "50.11",
        "remainingDaysOfServiceNetIpAddresses": "14.41"
    }
}]]>
                </literallayout>
            </section>
        </section>
    </chapter>
    <chapter>
        <title>Extended Customer API Operations</title>
        <section>
            <title>Assigning New Virtual IPs to a Load Balancer</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>POST</td>
                        <td>/loadbalancers/loadBalancerId/virtualips</td>
                        <td>Provision an additional virtual IP to a load balancer</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    This feature allows a user to provision a new PUBLIC or SERVICENET address to the specified load balancer.  This feature is restricted because a user must justify the need for additional IP addresses due to IANA requirements. An example of a reasonable justification would be the need to have a dedicated IP address for SSL termination.
                </para>
                <para>
                    To retrieve the assigned virtual IP, the caller must perform a subsequent GET on the /loadbalancers/loadBalancerId/virtualips URI.
                </para>
            </section>
            <section>
                <title>Sample XML POST Request (/loadbalancers/loadBalancerId/virtualips)</title>
                <literallayout class="monospaced">
<![CDATA[<virtualIp xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0 type="PUBLIC" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON POST Request (/loadbalancers/loadBalancerId/virtualips)</title>
                <literallayout class="monospaced">
<![CDATA[]{"virtualip": {
        "type": "PUBLIC"
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Synchronizing a Load Balancer</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>POST</td>
                        <td>/loadbalancers/loadBalancerId/sync</td>
                        <td>Synchronizes the load balancer with the authoritative source</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    This feature allows for a caller to synchronize the specified load balancer with a particular authoritative resource. At the time of this writing the authoritative source is the database in which all load balancer configurations are stored. We may plan on adding Zeus as an authoritative source later. If a caller chooses to synchronize from the database then Zeus will be updated to match the load balancer's configuration in the database. The caller only needs to send a POST request without a body to the specified URI. This feature should only be used in the event that Zeus contains mismatching configuration information (which should hopefully never even happen).
                </para>
            </section>
        </section>
        <section>
            <title>Suspending a Load Balancer</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/loadbalancers/loadBalancerId/suspension</td>
                        <td>Retrieve the current suspension information for the load balancer, if any</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>POST</td>
                        <td>/loadbalancers/loadBalancerId/suspension</td>
                        <td>Issues an immediate service suspension for a load balancer</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>DELETE</td>
                        <td>/loadbalancers/loadBalancerId/suspension</td>
                        <td>Removes the suspension for a load balancer</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    This feature allows for a caller to suspend and or unsuspend the specified load balancer.  In order to suspend a load balancer, the caller must supply a reason, the ticket issuer(user) and a ticket identifier, which can be viewed by other users with support and service admin access levels.
                </para>
                <para>
                    If a caller requests suspension details for an unsuspended load balancer, an empty suspension element <![CDATA[(<suspension />)]]> will be returned.
                </para>
                <note>
                    While customers are not permitted to delete suspended load balancers, a user with elevated permissions may do so by issuing a DELETE request against the /loadbalancers/loadBalancerId URI.
                </note>
            </section>
            <section>
                <title>Sample XML Response (/loadbalancers/loadBalancerId/suspension)</title>
                <literallayout class="monospaced">
<![CDATA[<suspension
   xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.00"
   reason="User suspected of fraud"
   ticketId="1054"
   user="jdoe" />]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/loadbalancers/loadBalancerId/suspension)</title>
                <literallayout class="monospaced">
<![CDATA[{"suspension": {
        "reason": "User suspected of fraud",
        "ticketId": "1054",
        "user": "jdoe"
    }
}]]>
                </literallayout>
            </section>
            <section>
                <title>Sample XML POST Request (/loadbalancers/loadBalancerId/suspension)</title>
                <literallayout class="monospaced">
<![CDATA[<suspension
   xmlns="http://docs.openstack.org/loadbalancers/api/management/v1.0"
   reason="Non-payment"
   ticketId="4141"
   user="bob"/>]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/loadbalancers/loadBalancerId/suspension)</title>
                <literallayout class="monospaced">
<![CDATA[{"suspension": {
        "reason": "Non-payment",
        "ticketId": "4141",
        "user": "bob"
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Viewing Extended Details of a Load Balancer</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/loadbalancers/loadBalancerId/extendedview</td>
                        <td>View extended details of a load balancer</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Description</title>
                <para>
                    This operation provides the detailed output for a specific load balancer configured and associated with the designated account.  It differs from the customer view because it provides the total active connections, host machine information, and a rate limit (if applicable) as part of the loadbalancer element.
                </para>
                <note>
                    An extended detail view is not available for a list of load balancers.
                </note>
            </section>
            <section>
                <title>Sample XML Response (/loadbalancers/loadBalancerId/extendedview)</title>
                <literallayout class="monospaced">
<![CDATA[<loadBalancer xmlns="http://docs.rackspacecloud.com/loadbalancers/api/v1.0"
   id="2000"
   name="sample-loadbalancer"
   protocol="HTTP"
   port="80"
   algorithm="RANDOM"
   status="ACTIVE"
   totalActiveConnections="340">
   <host id="1" type="ACTIVE" />
   <currentUsage
      incomingTransfer="1.40"
      outgoingTransfer="20.14" />
   <virtualIps>
      <virtualIp
         id="1000"
         address="206.10.10.210"
         type="PUBLIC" />
   </virtualIps>
   <nodes>
      <node
         nodeId="1041"
         ip="10.1.1.1"
         port="80"
         condition="ENABLED"
         status="ONLINE" />
      <node
         nodeId="1411"
         ip="10.1.1.2"
         port="80"
         condition="ENABLED"
         status="ONLINE" />
   </nodes>
   <sessionPersistence persistenceType="HTTP_COOKIE"/>
   <connectionLimits
      minConnections="10"
      maxConnectionsFromIp="100"
      maxConnectionRateFromIp="50"
      maxConnectionRateTimer="60" />
   <connectionLogging enabled="false" />
   <cluster name="c1.dfw1" />
      <ratelimit
          ticketId="4100"
          expirationTime="2010-10-17 00:00:00"
          maxRequestsPerSecond="100" />
   <created time="2010-06-01T12:00:00Z" />
   <updated time="2010-06-01T12:00:00Z" />
</loadBalancer>
]]>
                </literallayout>
            </section>
            <section>
                <title>Sample JSON Response (/loadbalancers/loadBalancerId/extendedview)</title>
                <literallayout class="monospaced">
<![CDATA[{"loadbalancer": {
        "id": "2000",
        "name": "sample-loadbalancer",
        "protocol": "HTTP",
        "port": "80",
        "algorithm": "RANDOM",
        "status": "ACTIVE",
        "totalActiveConnections": "340",
        "currentUsage": {
            "incomingTransfer": "1.40",
            "outgoingTransfer": "20.14"
        },
        "host": {
               "id": "1",
               "type": "ACTIVE"
         },
        "virtualIps": {
            "virtualIp": {
                "id": "1000",
                "address": "206.10.10.2010",
                "type": "PUBLIC"
            }
        },
        "nodes": {
            "node": [
                {
                    "nodeId": "1041",
                    "ip": "10.1.1.1",
                    "port": "9090",
                    "condition": "ENABLED",
                    "status": "ONLINE"
                },
                {
                    "nodeId": "1042",
                    "ip": "10.1.1.2",
                    "port": "80",
                    "condition": "ENABLED",
                    "status": "ONLINE"
                }
            ]
        },
        "connectionLogging": {
            "enabled": "true"
        },
        "rateLimit": {
            "ticketId": "1123",
            "expirationTime": "1283277190574",
            "maxRequestsPerSecond": "37"
        },
        "sessionPersistence": {
            "persistenceType": "HTTP_COOKIE"
        },
        "connectionLimits": {
            "minConnections": "10",
            "maxConnectionsFromIp": "100",
            "maxConnectionsRateFromIp": "50",
            "maxConnectionsRateTimer": "60"
        },
        "cluster": {
            "name": "c1.dfw1",
            "description": "Cluster Description"
        },
        "created": {
            "time": "2010-06-01 00: 00: 00"
        },
        "updated": {
            "time": "2010-06-01 00: 00: 00"
        }
    }
}]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Account Loadbalancers and Usage (Billing)</title>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/accounts/accountId/loadbalancers</td>
                        <td>Retrieves a list of load balancers on this account</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/accounts/billing/date</td>
                        <td>Retrieve usage for all accounts for a single day</td>
                        <td>Support, Service Admin, Billing</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                <emphasis>Normal Response Code(s):</emphasis> 200
            </para>
            <para>
                <emphasis>Error Response Code(s):</emphasis> loadBalancerManagementFault (400, 500), serviceUnavailable (503), unauthorized (401), badRequest (400), overLimit (413)
            </para>
            <section>
                <title>Description</title>
                <para>
                    A user can list all loadbalancers and their usage for the given account using these methods. The date parameters follow the yyyy-MM-dd date format. Please note that usage is retained for a maximum of 90 days.
                </para>
            </section>
            <section>
                <title>Sample XML Response (/accounts/accountId/loadbalancers)</title>
                <literallayout class="monospaced">
<![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:accountLoadBalancers xmlns="http://docs.openstack.org/loadbalancers/api/v1.0" xmlns:ns2="http://docs.openstack.org/loadbalancers/api/management/v1.0" accountId="1106">
    <ns2:accountLoadBalancer loadBalancerId="61" loadBalancerName="test1" clusterId="1" clusterName="Cluster Delta" protocol="HTTP" status="DELETED"/>
    <ns2:accountLoadBalancer loadBalancerId="62" loadBalancerName="test2" clusterId="1" clusterName="Cluster Delta" protocol="HTTPS" status="DELETED"/>
    <ns2:accountLoadBalancer loadBalancerId="66" loadBalancerName="My first loadbalancer" clusterId="1" clusterName="Cluster Delta" protocol="HTTP" status="ACTIVE"/>
    <ns2:accountLoadBalancer loadBalancerId="75" loadBalancerName="test3" clusterId="1" clusterName="Cluster Delta" protocol="HTTPS" status="DELETED"/>
    <ns2:accountLoadBalancer loadBalancerId="76" loadBalancerName="test4" clusterId="1" clusterName="Cluster Delta" protocol="HTTPS" status="PENDING_UPDATE"/>
    <ns2:accountLoadBalancer loadBalancerId="77" loadBalancerName="My second loadbalancer" clusterId="1" clusterName="Cluster Delta" protocol="HTTPS" status="ACTIVE"/>
</ns2:accountLoadBalancers>]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Load Balancer Status URL Management</title>
            <para>
                More often then not a LoadBalancer gets stuck in pending update due to a broken transaction that should have rolled back in the database but didn't.
            </para>
            <para>
                In this case an ops personal can use the following URL's to correct the issues.
            </para>
            <section>
                <title>Examples</title>
                <literallayout class="monospaced">
<![CDATA[loadbalancers/68/setstatus/ACTIVE
loadbalancers/68/setstatus/BUILD
loadbalancers/68/setstatus/DELETED
loadbalancers/68/setstatus/ERROR
loadbalancers/68/setstatus/PENDING_DELETE
loadbalancers/68/setstatus/PENDING_UPDATE
]]>
                </literallayout>
            </section>
        </section>
        <section>
            <title>Listing and Acknowledging Alerts</title>
            <para>
                This operations allows user to list all the alerts in the system. Additional information about the alert can be retrieved by alert id. The status of the alert can be changed to ACKNOWLEDGED using the PUT method
            </para>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/alert</td>
                        <td>Retrieve all alerts, if any</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/alerts/unacknowledged</td>
                        <td>Retrieve unacknowledged alerts, if any</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/alers/alertId</td>
                        <td>Retrieve details for the alert</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>GET</td>
                        <td>/loadbalancers/loadBalancerId/alerts</td>
                        <td>Retrieve all alerts for the specified load balancer, if any</td>
                        <td>Support, Service Admin</td>
                    </tr>
                    <tr align="left">
                        <td>PUT</td>
                        <td>/alerts/alertId/acknowledged</td>
                        <td>Acknowledge alert.  Changes the status of alert to ACKNOWLEDGED</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>Sample XML Response (/alerts)</title>
                <literallayout class="monospaced">
<![CDATA[<alerts>
   <alert id="1" accountId="38" loadbalancerid="1000" messageName="Error updating node" status=UNACKNOWLEDGED" created="2010-11-23"/>
</alerts>]]>
                </literallayout>
            </section>
            <section>
                <title>Adding group rate limiting</title>
                <para>
                    This operation allows user to add a group that will be used for API rate limiting. The definitions of the group are maintained in the rate limiting configuration file. The name of the group added has to match the name of the group in the configuration file
                </para>
                <informaltable rules="all">
                    <thead>
                        <tr>
                            <td>Verb</td>
                            <td>URI</td>
                            <td>Description</td>
                            <td>Access Level</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td>POST</td>
                            <td>/groups?name=xxx&amp;default=Y</td>
                            <td>Add group name and default</td>
                            <td>Support, Service Admin</td>
                        </tr>
                    </tbody>
                </informaltable>
            </section>
        </section>
        <section>
            <title>Viewing Events</title>
            <para>
                These operations allow support to view events.
            </para>
            <informaltable rules="all">
                <thead>
                    <tr>
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                        <td>Access Level</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>GET</td>
                        <td>/event/account/accountId/loadbalancer?startDate=2010-1-1&amp;endDate=2010-1-1</td>
                        <td>List recent load balancer service events on this account</td>
                        <td>Support, Service Admin</td>
                    </tr>
                </tbody>
            </informaltable>
            <section>
                <title>GET /management/event/account/accountId/loadbalancer?startDate=2010-1-1&amp;endDate=2010-1-1</title>
                <para>
The date parameters are optional. The results will list will be all load balancer service events that occurred between the start and end dates. by default the start date will be 60 days from the time of the request and the end date will be the date of the request. The result list will be inclusive for both dates.
                </para>
            </section>
            <section>
                <title>Sample XML Response (/alerts)</title>
                <literallayout class="monospaced">
<![CDATA[<accountLoadBalancerServiceEvents xmlns="http://docs.openstack.org/loadbalancers/api/v1.0" accountId="546428">
    <loadBalancerServiceEvents loadbalancerId="8">
        <loadBalancerServiceEvent author="abc" description="LoadBalancer successfully created" category="CREATE" severity="INFO" created="01/06/2011 10:37"/>
    </loadBalancerServiceEvents>
</accountLoadBalancerServiceEvents>]]>
                </literallayout>
            </section>
        </section>
    </chapter>
</book>
