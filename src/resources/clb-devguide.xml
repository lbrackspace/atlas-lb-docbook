<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book [
    <!-- Some useful entities borrowed from HTML -->
    <!ENTITY ndash  "&#x2013;">
    <!ENTITY mdash  "&#x2014;">
    <!ENTITY hellip "&#x2026;">

    <!-- Useful for describing APIs -->
    <!ENTITY GET    '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
    <!ENTITY PUT    '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
    <!ENTITY POST   '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
    <!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>

    <!ENTITY CHECK  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
        <imageobject>
        <imagedata fileref="img/Check_mark_23x20_02.svg"
        format="SVG" scale="60"/>
        </imageobject>
        </inlinemediaobject>'>

    <!ENTITY ARROW  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
        <imageobject>
        <imagedata fileref="img/Arrow_east.svg"
        format="SVG" scale="60"/>
        </imageobject>
        </inlinemediaobject>'>
]>
<book version="5.0" xmlns="http://docbook.org/ns/docbook"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:svg="http://www.w3.org/2000/svg"
      xmlns:m="http://www.w3.org/1998/Math/MathML"
      xmlns:html="http://www.w3.org/1999/xhtml"
      xmlns:db="http://docbook.org/ns/docbook">
    <?rax title.font.size="35px" subtitle.font.size="20px"?>
    <title>Cloud Load Balancers Developer Guide</title>
    <titleabbrev>Cloud LB Dev Guide</titleabbrev>
    <info>
        <author>
            <personname>
                <firstname/>
                <surname/>
            </personname>
            <affiliation>
                <orgname>Open Stack</orgname>
            </affiliation>
        </author>
        <releaseinfo>API v1.1</releaseinfo>
        <productname>Load Balancers</productname>
        <pubdate>2011-04-19</pubdate>
        <legalnotice role="rs-api">
            <annotation>
                <remark>Copyright details are filled in by the template.</remark>
            </annotation>
        </legalnotice>
        <abstract>
            <para>This document is intended for software developers interested in developing
                applications using the Cloud Load Balancers Application Program Interface
                (<abbrev>API</abbrev>).
            </para>
        </abstract>
        <cover>
            <para>this is a placeholder for the front cover</para>
        </cover>
        <cover>
            <para>this is a placeholder for the back cover</para>
        </cover>
    </info>
    <chapter>
        <title>Overview</title>
        <section>
            <title>Intended Audience</title>
            <para>This guide is intended for software developers who want to create applications using
                the Cloud Load Balancers API. It assumes the reader has a general understanding of
                load balancing concepts and is familiar with:
            </para>
            <para>
                <itemizedlist spacing="compact">
                    <listitem>
                        <para>ReSTful web services</para>
                    </listitem>
                    <listitem>
                        <para>HTTP/1.1 conventions</para>
                    </listitem>
                    <listitem>
                        <para>JSON and/or XML serialization formats</para>
                    </listitem>
                </itemizedlist>
            </para>
        </section>
        <section>
            <title>Document Change History</title>
            <para>This version of the Developer Guide replaces and obsoletes all previous versions.
                The most recent changes are described in the table below: </para>
            <informaltable rules='all'>
                <thead>
                    <tr align="center">
                        <td colspan="1">Revision Date</td>
                        <td colspan="4">Summary of Changes</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1" align="center">Apr. 19, 2011</td>
                        <td colspan="4" align="left">
                            <itemizedlist spacing="compact">
                                <listitem>
                                    <para>Added details to support initial GA release.</para>
                                </listitem>
                            </itemizedlist>
                        </td>
                    </tr>
                    <tr align="left">
                        <td colspan="1" align="center">Mar. 2, 2011</td>
                        <td colspan="4" align="left">
                            <itemizedlist spacing="compact">
                                <listitem>
                                    <para>Revised code samples and formatting to address initial beta feedback.</para>
                                </listitem>
                            </itemizedlist>
                        </td>
                    </tr>
                    <tr align="left">
                        <td colspan="1" align="center">Feb. 23, 2011</td>
                        <td colspan="4" align="left">
                            <itemizedlist spacing="compact">
                                <listitem>
                                    <para>Initial release for public beta.</para>
                                </listitem>
                            </itemizedlist>
                        </td>
                    </tr>
                </tbody>
            </informaltable>
        </section>
        <section>
            <title>Additional Resources</title>
            <para>You can download the most current version of this document from the Rackspace Cloud website at <link
                xlink:href="http://docs.rackspacecloud.com/loadbalancers/api/clb-devguide-latest.pdf">
                http://docs.rackspacecloud.com/loadbalancers/api/clb-devguide-latest.pdf</link>. </para>
            <para>For more details about the Rackspace Cloud Load Balancer service, refer to <link
                    xlink:href="http://www.rackspace.com/cloud/cloud_hosting_products/loadbalancers/"
                    >http://www.rackspace.com/cloud/cloud_hosting_products/loadbalancers/</link>.
                This site also offers links to Rackspace's official support channels, including
                knowledge base articles, forums, phone, chat, and email. </para>
            <para>You can also follow updates and announcements via twitter at <link
                    xlink:href="http://www.twitter.com/Rackspace">http://www.twitter.com/Rackspace</link>.
            </para>
        </section>
    </chapter>
    <chapter>
        <title>Concepts</title>
        <para>To use Cloud Load Balancers API effectively, you should understand several key
            concepts:
        </para>
        <section>
            <title>Load Balancer</title>
            <para>A load balancer is a logical device which belongs to a cloud account. It is used
                to distribute workloads between multiple back-end systems or services, based on the
                criteria defined as part of its configuration.
            </para>
        </section>
        <section>
            <title>Virtual IP</title>
            <para>A virtual IP is an Internet Protocol (IP) address configured on the load balancer
                for use by clients connecting to a service that is load balanced. Incoming
                connections are distributed to back-end nodes based on the configuration of the load
                balancer. </para>
        </section>
        <section>
            <title>Node</title>
            <para>A node is a back-end device providing a service on a specified IP and port.</para>
        </section>
        <section>
            <title>Health Monitor</title>
            <para>A health monitor is a feature of each load balancer. It is used to determine
                whether or not a back-end node is usable for processing a request. The load
                balancing service supports two types of health monitors: passive and active. </para>
            <section>
                <title>Passive Health Monitor</title>
                <para>By default, all load balancing configurations utilize a passive health
                    monitor, which is the default monitoring and does not require configuration from
                    the user. If the passive health monitoring determines that a node is down, unreachable
                    or malfunctioning, it puts the node in an OFFLINE state and stops sending traffic to it.</para>
            </section>
            <section>
                <title>Active Health Monitor</title>
                <para>Active health monitoring is a technique that uses synthetic transactions
                    executed at periodic intervals to determine the condition of a node. When active
                    monitoring is enabled, it takes over the monitoring of the nodes, and passive
                    monitoring is disabled. Conversely, when active monitoring configuration is removed
                    by the user, passive monitoring is re-enabled for the nodes of the load balancer</para>
                <para>The active health monitor can use one of three types of probes:
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>
                                connect
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                HTTP
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                HTTPS
                            </para>
                        </listitem>
                    </itemizedlist>
                    These probes are executed at configured intervals; in the event of a failure, the node
                    status changes to
                    <code>OFFLINE</code>
                    and the node will not receive traffic. If, after running a subsequent test, the probe
                    detects that the node has recovered, then the node's status is changed to
                    <code>ONLINE</code>
                    and it is capable of servicing requests.
                </para>
            </section>
        </section>
        <section>
            <title>Session Persistence</title>
            <para>Session persistence is a feature of the load balancing service. It attempts to
                force subsequent connections to a service to be redirected to the same node as long
                as it is online. </para>
        </section>
        <section>
            <title>Connection Logging</title>
            <para>The connection logging feature allows for retrieving access logs (for HTTP-based protocol
                   traffic) or connectio and transfer logs (for all other traffic) </para>
        </section>
    </chapter>
    <chapter>
        <title>General API Information</title>
        <para>Ideas explained here are relevant to all operations of the OpenStack API.</para>
        <section>
            <title>Authentication</title>
            <para>Common to OpenStack API</para>
        </section>
        <section>
            <title>Service Access/Endpoints</title>
            <para>Common to OpenStack API</para>
        </section>
        <section>
            <title>Request/Response Types</title>
            <para>The  Cloud Load Balancers API supports both the JSON and XML data serialization
                formats. The request format is specified using the
                <code>Content-Type</code>
                header and is required for operations that have a request body. The response format can be
                specified in requests using either the
                <code>Accept</code>
                header or adding an
                <code>.xml</code>
                or
                <code>.json</code>
                extension to the request URI. Note that it is possible for a response to be serialized using
                a format different from the request. If no response format is specified, JSON is the default.
                If conflicting formats are specified using both an
                <code>Accept</code>
                header and a query extension, the query extension takes precedence.
            </para>
            <table rules="all">
                <caption>JSON and XML Response Formats</caption>
                <thead>
                    <tr align="center">
                        <td>Format</td>
                        <td>Accept Header</td>
                        <td>Query Extension</td>
                        <td>Default</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>JSON</td>
                        <td>application/json</td>
                        <td>.json</td>
                        <td>Yes</td>
                    </tr>
                    <tr align="left">
                        <td>XML</td>
                        <td>application/xml</td>
                        <td>.xml</td>
                        <td>No</td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section>
            <title>Content Compression</title>
            <para>Commong to all of OpenStackAPI</para>
        </section>
        <section>
            <title>Persistent Connections</title>
             <para>Commong to all of OpenStackAPI</para>
        </section>
        <section>
            <title>Paginated Collections</title>
            <para>Commong to all of OpenStackAPI</para>
        </section>
        <section>
            <title>Limits</title>
            <para>Limits that are query-able beforehand on things like max name length, max VIPs per load balancer,
                  max health monitors per load balancer, etc
            </para>
            <section>
                <title>Determining Limits Programmatically</title>
                <para>
                    Applications can programmatically determine current application limits - this needs to be
                    further defined</para>
                 </section>
        </section>
        <section>
            <title>Faults</title>
            <para> API calls that return an error return one of the following fault objects. All
                fault objects extend from the base fault, <code>serviceFault</code>, for easier
                exception handling for languages that support it. Again these are probably
                common to all OpenStack APIs</para>
        </section>
    </chapter>
    <chapter>
        <title>API Operations</title>
        <para>This chapter explains specific API operations. For ideas relevant to all API operations, see the "General API Information" chapter.</para>
        <section>
            <title>Load Balancers</title>
        <section>
            <title>List Load Balancers</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                        <td colspan="2">Representation</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&GET;</td>
                        <td colspan="3">/loadbalancers</td>
                        <td colspan="3">List all load balancers configured for the account (IDs, names and
                            status only).</td>
                        <td colspan="2">XML, JSON</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>
                This operation provides a list of all load balancers configured and associated with your account.
            </para>
            <para>
                To view deleted load balancers, add "?status=DELETED" to the end of the get url. A deleted load
                balancer is immutable and irrecoverable. Only a limited set of attributes will be
                returned in the response object:
            </para>
            <itemizedlist spacing="compact">
                <listitem>
                    <para>
                        <code>id</code>
                    </para>
                </listitem>
                <listitem>
                    <para>
                        <code>name</code>
                    </para>
                </listitem>
                <listitem>
                    <para>
                        <code>created</code>
                    </para>
                </listitem>
                <listitem>
                    <para>
                        <code>updated</code>
                    </para>
                </listitem>
            </itemizedlist>
            <para>
                This operation does not require a request body.
            </para>
            <example>
                <title>List Load Balancers Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Load Balancers Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-response.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        <section>
            <title>List Load Balancer Details</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                        <td colspan="2">Representations</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&GET;
                        </td>
                        <td colspan="3">/loadbalancers/loadBalancerId</td>
                        <td colspan="3">List details of the specified load balancer.</td>
                        <td colspan="2">JSON, XML</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>This operation provides detailed output for a specific load balancer
                configured and associated with your account. This operation is not capable of
                returning details for a load balancer which has been deleted.
            </para>
            <para>
                This operation does not require a request body.
            </para>
            <example>
                <title>List Load Balancer Details Request: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-details-request.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Load Balancers Details Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-details-response.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        <section>
            <title>Create Load Balancer</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&POST;
                        </td>
                        <td colspan="3">/loadbalancers</td>
                        <td colspan="3">Create a new load balancer with the configuration defined by the request.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>This operation asynchronously provisions a new load balancer based on the
                configuration defined in the request object. Once the request is validated and
                progress has started on the provisioning process, a response object will be
                returned. The object will contain a unique identifier and status of the request.
                Using the identifier, the caller can check on the progress of the operation by
                performing a &GET; on <code>loadbalancers/id</code>. If the corresponding request cannot be
                fulfilled due to insufficient or invalid data, an <code>HTTP</code>
                <returnvalue>400 (Bad Request)</returnvalue>
                error response will be returned with information regarding the nature of the failure in
                the body of the response. Failures in the validation process are non-recoverable and
                require the caller to correct the cause of the failure and &POST; the request again.
            </para>
            <note>
                <para>
                    A load balancer's name has a length that is configurable and can be queried when
                    querying limits.
                </para>
            </note>
            <note>
                <para> Users may configure all documented features of the load balancer at creation
                        time by simply providing the additional elements or attributes in the
                        request. This document provides an overview of all the features the load
                        balancing service supports. </para>
            </note>
            <example>
                <title>Create Load Balancer (Required Attributes) Request: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-create-required-request.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Create Load Balancer (Required Attributes) Request: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-create-required-request.json" parse="text"/>
                </programlisting>
            </example>
            <para>If you have at least one load balancer, you may
                    create subsequent load balancers that share a single virtual IP by issuing a
                    &POST; and supplying a virtual IP ID instead of a type. Additionally, this
                    feature is highly desirable if you wish to load balance both an unsecured and
                    secure protocol using one IP or DNS name. For example, this method makes it
                    possible to use the same load balancing configuration to support
                        <code>HTTP</code> and <code>HTTPS</code>). </para>
            <note>
                <para>
                    Load balancers sharing a virtual IP
                    <emphasis>must</emphasis>
                    utilize a unique port.
                </para>
            </note>
            <example>
                <title>Create Load Balancer (Required Attributes with Shared IP) Request: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-create-required-sharedip-request.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Create Load Balancer (Required Attributes with Shared IP) Request: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-create-required-sharedip-request.json" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Create Load Balancer (Required Attributes with Shared IP) Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-create-required-sharedip-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Create Load Balancer (Required Attributes with Shared IP) Response:
                        JSON</title>
                <programlisting>
<xi:include href="samples/lb-create-required-sharedip-response.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        <section>
                <title>Update Load Balancer Attributes</title>
                <informaltable rules="all">
                    <thead>
                        <tr align="center">
                            <td colspan="1">Verb</td>
                            <td colspan="3">URI</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">&PUT;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter></td>
                            <td colspan="3">Update the properties of a load balancer.</td>
                        </tr>
                    </tbody>
                </informaltable>
                <para>
                    Normal Response Code(s):
                    <returnvalue>202</returnvalue>
                </para>
                <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                    <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                    unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                    overLimit (<errorcode>413</errorcode>)
                </simpara>
                <para> This operation asynchronously updates the attributes of the specified load
                    balancer. Upon successful validation of the request, the service will return a
                        <returnvalue>202 (Accepted)</returnvalue> response code. A caller can poll
                    the load balancer with its ID to wait for the changes to be applied and the load
                    balancer to return to an <code>ACTIVE</code> status.</para>
                <para>
                    This operation allows the caller to change one or more of the following attributes:
                </para>
                <itemizedlist spacing="compact">
                    <listitem>
                        <para>
                            <code>name</code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code>algorithm</code>
                        </para>
                    </listitem>

                </itemizedlist>
                <para>
                    This operation does not return a response body.
                </para>
                <note>
                    <para>
                        The load balancer's ID and status are immutable attributes
                        (do we need to add port and and protocol here as well?) Leaving
                        them in for now and cannot be modified by the
                        caller. Supplying an unsupported attribute will result in a
                        <returnvalue>400 (badRequest)</returnvalue>
                        fault.
                    </para>
                </note>
                <example>
                    <title>Update Load Balancer Attributes Request: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-update-lb-attributes-request.xml" parse="text"/>
                </programlisting>
                </example>
                <example>
                    <title>Update Load Balancer Attributes Request: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-update-lb-attributes-request.json" parse="text"/>
                </programlisting>
                </example>
                <para>All load balancers also have a status attribute to signify the current
                    configuration status of the device. This status is immutable by the caller and is
                    updated automatically based on state changes within the service. When a load
                    balancer is first created, it will be placed into a <code>BUILD</code> status while
                    the configuration is being generated and applied based on the request. Once the
                    configuration is applied and finalized, it will be in an <code>ACTIVE</code> status.
                    In the event of a configuration change or update, the status of the load balancer
                    will change to <code>PENDING_UPDATE</code> to signify configuration changes are in
                    progress but have not yet been finalized. Load balancers in a <code>SUSPENDED</code>
                    status are configured to reject traffic and will not forward requests to back-end
                    nodes. </para>
                <table rules="all">
                    <caption>Load Balancer Statuses</caption>
                    <thead>
                        <tr align="center">
                            <td colspan="1">Name</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">
                                <code>ACTIVE</code>
                            </td>
                            <td colspan="3">
                                Load balancer is configured properly and ready to serve traffic to incoming requests
                                via the configured virtual IPs.
                            </td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                <code>BUILD</code>
                            </td>
                            <td colspan="3">
                                Load balancer is being provisioned for the first time and configuration is being
                                applied to bring the service online. The service will not yet be ready to serve
                                incoming requests.
                            </td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                <code>PENDING_UPDATE</code>
                            </td>
                            <td colspan="3"> Load balancer is online but configuration changes are
                                being applied to update the service based on a previous request. </td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                <code>PENDING_DELETE</code>
                            </td>
                            <td colspan="3"> Load balancer is online but configuration changes are
                                being applied to begin deletion of the service based on a previous
                                request. </td>
                        </tr>
                        <tr align="left">
                            <td colspan="1" >
                                <code>SUSPENDED</code>
                            </td>
                            <td colspan="3">
                                Load balancer has been taken offline and disabled; contact Support.
                            </td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                <code>ERROR</code>
                            </td>
                            <td colspan="3">
                                The system encountered an error when attempting to configure the load
                                balancer; contact Support.
                            </td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                <code>DELETED</code>
                            </td>
                            <td colspan="3"> Load balancers in <code>DELETED</code> status can be
                                displayed for a certain number of days after deletion.The number of days is configuraable </td>
                        </tr>
                    </tbody>
                </table>
        </section>
            <section>
                <title>Remove Load Balancer</title>
                <informaltable rules="all">
                    <thead>
                        <tr align="center">
                            <td colspan="1">Verb</td>
                            <td colspan="3">URI</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">&DELETE;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter></td>
                            <td colspan="3">Remove a load balancer from the account.</td>
                        </tr>
                    </tbody>
                </informaltable>
                <para>
                    Normal Response Code(s):
                    <returnvalue>202</returnvalue>
                </para>
                <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                    <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                    unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                    overLimit (<errorcode>413</errorcode>)
                </simpara>
                <para>
                    The remove load balancer function removes the specified load balancer and its associated
                    configuration from the account. Any and all configuration data is immediately purged and
                    is not recoverable.
                </para>
                <para>
                    This operation does not require a request body.
                </para>
                <para>
                    This operation does not return a response body.
                </para>
            </section>
        </section>
        <section>
            <title>Nodes</title>
            <para>The nodes defined by the load balancer are responsible for servicing the requests
                received through the load balancer's virtual IP. By default, the load balancer
                employs a basic health check that ensures the node is listening on its defined port.
                The node is checked at the time of addition and at regular intervals as defined by
                the load balancer health check configuration. If a back-end node is not listening on
                its port or does not meet the conditions of the defined active health check for the
                load balancer, then the load balancer will not forward connections and its status
                will be listed as <code>OFFLINE</code>. Only nodes that are in an
                <code>ONLINE</code> status will receive and be able to service traffic from the
                load balancer. </para>
            <para>All nodes have an associated status that indicates whether the node is
                <code>ONLINE</code>, <code>OFFLINE</code>. Only nodes
                that are in <code>ONLINE</code> status will receive and be able to service traffic
                from the load balancer. The <code>OFFLINE</code> status represents a node that
                cannot accept or service traffic. The "draining node" can be added as an extension.
                If the traffic manager receives a requestand session persistence requires that the node is used,
                the traffic manager will use it. The status is determined by the passive or active health
                monitors. </para>
            <para>The caller can assign weights to the nodes as part of the weight attribute of the node
                  element. When the nodes do not already have an assigned weight, the service will automatically
                  set the weight to "1" for all nodes.
            </para>
            <para>When a node is added, it is assigned a unique identifier that can be used for mutating
                  operations such as changing the condition and removing it.
            </para>
            <section>
                <title>List Nodes</title>
                <informaltable rules="all">
                    <thead>
                        <tr align="center">
                            <td colspan="1">Verb</td>
                            <td colspan="3">URI</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">
                                &GET;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/nodes</td>
                            <td colspan="3">List node(s) configured for the load balancer.</td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                &GET;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/nodes/<parameter>nodeId</parameter></td>
                            <td colspan="3">List details of a specific node.</td>
                        </tr>
                    </tbody>
                </informaltable>
                <para>
                    Normal Response Code(s):
                    <returnvalue>200</returnvalue>,
                    <returnvalue>202</returnvalue>
                </para>
                <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                    <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                    unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                    overLimit (<errorcode>413</errorcode>)
                </simpara>
                <para>
                    This operation does not require a request body.
                </para>
                <example>
                    <title>List Node Response: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-list-node-response.xml" parse="text"/>
                </programlisting>
                </example>
                <example>
                    <title>List Node Response: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-list-node-response.json" parse="text"/>
                </programlisting>
                </example>
                <example>
                    <title>List Nodes Response: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-list-nodes-response.xml" parse="text" />
                </programlisting>
                </example>
                <example>
                    <title>List Nodes Response: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-list-nodes-response.json" parse="text" />
                </programlisting>
                </example>
            </section>
            <section>
                <title>Add Nodes</title>
                <informaltable rules="all">
                    <thead>
                        <tr align="center">
                            <td colspan="1">Verb</td>
                            <td colspan="3">URI</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">
                                &POST;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/nodes</td>
                            <td colspan="3">Add a new node to the load balancer.</td>
                        </tr>
                    </tbody>
                </informaltable>
                <para>
                    Normal Response Code(s):
                    <returnvalue>200</returnvalue>,
                    <returnvalue>202</returnvalue>
                </para>
                <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                    <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                    unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                    overLimit (<errorcode>413</errorcode>)
                </simpara>
                <para>
                    This operation does not require a request body.
                </para>
                <para>When a node is added, it is assigned a unique identifier that can be used
                    for mutating operations such as changing the condition or removing it.
                    Every load balancer is dual-homed on both the public Internet and private; as a
                    result, nodes can either be internal private addresses or addresses on the public
                    Internet.
                </para>
                <example>
                    <title>Add Nodes Request: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-add-nodes-request.xml" parse="text" />
                </programlisting>
                </example>
                <example>
                    <title>Add Nodes Request: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-add-nodes-request.json" parse="text" />
                </programlisting>
                </example>
                <example>
                    <title>Add Nodes Response: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-add-nodes-response.xml" parse="text"/>
                </programlisting>
                </example>
                <example>
                    <title>Add Nodes Response: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-add-nodes-response.json" parse="text"/>
                </programlisting>
                </example>
            </section>
            <section>
                <title>Modify Nodes</title>
                <informaltable rules="all">
                    <thead>
                        <tr align="center">
                            <td colspan="1">Verb</td>
                            <td colspan="3">URI</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">
                                &PUT;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/nodes/<parameter>nodeId</parameter></td>
                            <td colspan="3">Modify the configuration of a node on the load balancer.</td>
                        </tr>
                    </tbody>
                </informaltable>
                <para>
                    Normal Response Code(s):
                    <returnvalue>200</returnvalue>,
                    <returnvalue>202</returnvalue>
                </para>
                <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                    <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                    unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                    overLimit (<errorcode>413</errorcode>)
                </simpara>
                <para>
                    This operation does not require a request body.
                </para>
                <note>
                    <para>The node's IP and port are immutable attributes and cannot be modified with a
                        &PUT; request. Supplying an unsupported attribute will result in a
                        <returnvalue>400 (badRequest)</returnvalue> fault. A load balancer supports
                        a maximum number of nodes. The number of nodes is a configurable property;
                        the maximum weight of a node is 100. </para>
                </note>
                <para>Every node in the load balancer has an associated condition which determines
                    its role within the load balancer.
                </para>
                <table rules="all">
                    <caption>Load Balancer Node Conditions</caption>
                    <?dbfo keep-together="always"?>
                    <thead>
                        <tr align="center">
                            <td colspan="1">Name</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">
                                <code>ENABLED</code>
                            </td>
                            <td colspan="3">Node is permitted to accept new connections.</td>
                        </tr>
                        <tr align="left">
                            <td colspan="1">
                                <code>DISABLED</code>
                            </td>
                            <td colspan="3">Node is not permitted to accept any new connections
                                regardless of session persistence configuration. Existing connections
                                are forcibly terminated.</td>
                        </tr>
                    </tbody>
                </table>
                <example>
                    <title>Update Node Condition Request: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-update-node-request.xml" parse="text"/>
                </programlisting>
                </example>
                <example>
                    <title>Update Node Condition Request: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-update-node-request.json" parse="text"/>
                </programlisting>
                </example>
            </section>
            <section>
                <title>Remove Nodes</title>
                <informaltable rules="all">
                    <thead>
                        <tr align="center">
                            <td colspan="1">Verb</td>
                            <td colspan="3">URI</td>
                            <td colspan="3">Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="left">
                            <td colspan="1">
                                &DELETE;
                            </td>
                            <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/nodes/<parameter>nodeId</parameter></td>
                            <td colspan="3">Remove a node from the load balancer.</td>
                        </tr>
                    </tbody>
                </informaltable>
                <para>
                    Normal Response Code(s):
                    <returnvalue>200</returnvalue>,
                    <returnvalue>202</returnvalue>
                </para>
                <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                    <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                    unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                    overLimit (<errorcode>413</errorcode>)
                </simpara>
                <para>
                    This operation does not require a request body.
                </para>
            </section>
        </section>
        <section>
            <title>Virtual IPs</title>
            <para>
                A virtual IP (VIP) makes a load balancer accessible by clients. The load
                balancing service supports either a public VIP, routable on the public Internet, or
                a private address, routable only within the region in which the load balancer
                resides.
            </para>
            <table rules="all">
                <caption>Virtual IP Types</caption>
                <?dbfo keep-together="always"?>
                <thead>
                    <tr align="center">
                        <td colspan="1">Name</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">
                            <code>PUBLIC</code>
                        </td>
                        <td colspan="3">An address that is routable on the public Internet.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="1">
                            <code>INTERNAL</code>
                        </td>
                        <td colspan="3">An address that is routable only on internal network.</td>
                    </tr>
                </tbody>
            </table>
        <section>
            <title>List Virtual IPs</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&GET;
                        </td>
                        <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/virtualips</td>
                        <td colspan="3">List all virtual IPs associated with a load balancer.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>,
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>
                This request does not require a request body.
            </para>
            <example>
                <title>List Virtual IPs Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-vips-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Virtual IPs Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-vips-response.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        <section>
            <title>Remove Virtual IP</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&DELETE;
                        </td>
                        <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/<parameter>virtualIpId</parameter></td>
                        <td colspan="3">Remove a virtual IP.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>,
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>
                This request does not require a request body.
            </para>
            <note>
                <para>All load balancers must have at least one virtual IP associated with
                    them at all times. Attempting to delete the last virtual IP will result in a
                    <returnvalue>400 (badRequest)</returnvalue>
                    fault.
                </para>
            </note>
        </section>
        </section>
        <section>
            <title>Usage Reports</title>
        <section>
            <title>List Usage</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td>Name</td>
                        <td>URI</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>&GET;
                        </td>
                        <td>/loadbalancers/loadBalancerId/usage</td>
                        <td>List current and historical usage.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>
                This operation does not require a request body.
            </para>
            <para>The load balancer usage reports provide a minimumum set of usage counters.
                  This list will definded such that it is supported by differen load balancing
                 technologies. Values to be considered are incoming/outgoing transfer of bytes.</para>
        </section>
        </section>
         <section>
            <title>Monitors</title>
            <para>The load balancing service includes a health monitoring operation which
                periodically checks your back-end nodes to ensure they are responding correctly. If
                a node is not responding, it is removed from rotation until the health monitor
                determines that the node is functional. In addition to being performed periodically,
                the health check also is performed against every node that is added to ensure that
                the node is operating properly before allowing it to service traffic. A loadbalancer will
                have a configurable amount of health monitors at a time.
            </para>
            <para>
                Every health monitor has a <code>type</code> attribute to signify what kind of monitor it is.
            </para>
            <table rules="all">
                <caption>Health Monitor Types</caption>
                <?dbfo keep-together="always"?>
                <thead>
                    <tr align="center">
                        <td colspan="1">Name</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">CONNECT</td>
                        <td colspan="3">Health monitor is a connect monitor.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="1">HTTP</td>
                        <td colspan="3">Health monitor is an HTTP monitor.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="1">HTTPS</td>
                        <td colspan="3">Health monitor is an HTTPS monitor.</td>
                    </tr>
                </tbody>
            </table>
        <section>
            <title>Monitor Health</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&GET;
                        </td>
                        <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/healthmonitor</td>
                        <td colspan="3">Retrieve the health monitor configuration, if one exists.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="1">&PUT;
                        </td>
                        <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/healthmonitor</td>
                        <td colspan="3">Update the settings for a health monitor.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="1">&DELETE;
                        </td>
                        <td colspan="3">/loadbalancers/<parameter>loadBalancerId</parameter>/healthmonitor</td>
                        <td colspan="3">Remove the health monitor.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>,
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <section>
                <title>Monitor Connections</title>
                <para>The monitor connects to each node on its defined port to ensure that the
                    service is listening properly. The connect monitor is the most basic type of
                    health check and does no post-processing or protocol specific health checks. It
                    includes several configurable properties:
                </para>
                <para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>
                                <code>delay</code>: The minimum number of seconds to wait before checking the health
                                      of a node after it is put into OFFLINE status.
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <code>timeout</code>: Maximum number of seconds to wait for a connection to be
                                established before timing out.
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <code>attemptsBeforeDeactivation</code>: Number of permissible monitor failures
                                before removing a node from rotation. (Must be a number between 1 and 10)
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
                <example>
                    <title>Monitor Connections Request: XML</title>
                    <programlisting language="xml">
<xi:include href="samples/lb-monitor-connect-request.xml" parse="text"/>
                </programlisting>
                </example>
                <example>
                    <title>Monitor Connections Request: JSON</title>
                    <programlisting language="javascript">
<xi:include href="samples/lb-monitor-connect-request.json" parse="text"/>
                </programlisting>
                </example>
            <example>
                <title>Monitor Connections Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-monitor-connect-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Monitor Connections Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-monitor-connect-response.json" parse="text"/>
                </programlisting>
            </example>
            </section>
            <section>
                <title>Monitor HTTP and HTTPS</title>
                <para> The HTTP and HTTPS monitor is more intelligent than the connect monitor. It
                        is capable of processing an HTTP or HTTPS response to determine the
                        condition of a node. It supports the same basic properties as the connect
                        monitor and includes additional attributes that are used to evaluate the
                        HTTP response. Available attributes are: </para>
                <para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>
                                <code>delay</code>: The minimum number of seconds to wait before executing the
                                health monitor. (Must be a number between 1 and 3600)
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <code>timeout</code>: The maximum number of seconds to wait for a connection to be
                                established before timing out. (Must be a number between 1 and 300)
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <code>attemptsBeforeDeactivation</code>: The number of permissible monitor failures
                                before removing a node from rotation. (Must be a number between 1 and 10)
                            </para>
                        </listitem>
                        <listitem>
                            <para><code>path</code>: The HTTP path that will be used in the sample request.
                                The most basic proposal could be to support path only and assume that method is
                                always GET
                                and that status code is expected to be always 200 to declare probe success.
                                This will be widely supported but  is not very powerful. Needs researching
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
            <example>
                <title>Monitor HTTP Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-monitor-http-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Monitor HTTPS Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-monitor-https-response.xml" parse="text"/>
                </programlisting>
            </example>
            </section>
        </section>
        </section>
        <section>
            <title>Sessions</title>
        <section>
            <title>Manage Session Persistence</title>
            <para>Session persistence is a feature of the load balancing service which
                forces multiple requests from clients to be directed to the same node. This is
                common with many web applications that do not inherently share application state
                between back-end servers.
            </para>
            <table rules="all">
                <caption>Session Persistence Modes</caption>
                <?dbfo keep-together="always"?>
                <thead>
                    <tr align="center">
                        <td colspan="1">Name</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">HTTP_COOKIE</td>
                        <td colspan="3">A session persistence mechanism that inserts an HTTP cookie and
                            is used to determine the destination back-end node. This is supported
                            for HTTP load balancing only.
                        </td>
                    </tr>
                </tbody>
            </table>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>&GET;
                        </td>
                        <td>/loadbalancers/loadBalancerId/sessionpersistence</td>
                        <td>List session persistence configuration.</td>
                    </tr>
                    <tr align="left">
                        <td>&PUT;
                        </td>
                        <td>/loadbalancers/loadBalancerId/sessionpersistence</td>
                        <td>Enable session persistence.</td>
                    </tr>
                    <tr align="left">
                        <td>&DELETE;
                        </td>
                        <td>/loadbalancers/loadBalancerId/sessionpersistence</td>
                        <td>Disable session persistence.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>,
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <example>
                <title>List Session Persistence Configuration Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-persistence-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Session Persistence Configuration Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-persistence-response.json" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Set Session Persistence Type Request: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-set-persistence-request.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Set Session Persistence Type Request: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-set-persistence-request.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        </section>
        <section>
            <title>Connections</title>
        <section>
            <title>Log Connections</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&GET;
                        </td>
                        <td colspan="3">/loadbalancers/loadBalancerId/connectionlogging</td>
                        <td colspan="3">View current configuration of connection logging.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="1">&PUT;
                        </td>
                        <td colspan="3">/loadbalancers/loadBalancerId/connectionlogging</td>
                        <td colspan="3">Enable or disable connection logging.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>,
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>This operation allows the user to view the current connection logging
                    configuration, enable connection logging, or disable connection logging. </para>
            <para>
                This operation does not require a request body.
            </para>
            <example>
                <title>List Connection Logging Configuration Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-logging-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Connection Logging Configuration Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-logging-response.json" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Enable Connection Logging Request: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-enable-logging-request.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Enable Connection Logging Request: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-enable-logging-request.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        <section>
            <title>Throttle Connections</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>&GET;
                        </td>
                        <td>/loadbalancers/loadBalancerId/connectionthrottle</td>
                        <td>List connection throttling configuration.</td>
                    </tr>
                    <tr align="left">
                        <td>&PUT;
                        </td>
                        <td>/loadbalancers/loadBalancerId/connectionthrottle</td>
                        <td>Update throttling configuration.</td>
                    </tr>
                    <tr align="left">
                        <td>&DELETE;
                        </td>
                        <td>/loadbalancers/loadBalancerId/connectionthrottle</td>
                        <td>Remove connection throttling configurations.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>,
                <returnvalue>202</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>This operation does not require a request body.</para>
            <para>
                The connection throttling feature imposes limits on the number of connections per IP address to
                help mitigate malicious or abusive traffic to your applications. The following properties can be
                configured based on the traffic patterns for your sites.
            </para>
            <itemizedlist spacing="compact">
                <listitem>
                    <para>
                            <code>maxRequestRate</code>: Maximum number of requests allowed
                            from a single IP address in the defined <code>rateInterval</code>.
                            Setting a value of 0 allows an unlimited connection rate; otherwise, set
                            a value between 1 and 100000. </para>
                </listitem>
                <listitem>
                    <para><code>rateInterval</code>: Frequency (in seconds) at which the
                                <code>maxReqestRate</code> is assessed. For example, a
                                <code>maxRequestRate</code> of 30 with a
                                <code>rateInterval</code> of 60 would allow a maximum of 30
                            connections per minute for a single IP address. This value must be
                            specified between 1 and 3600. </para>
                </listitem>
            </itemizedlist>
            <example>
                <title>List Connection Throttling Configuration Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-throttling-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Connection Throttling Configuration Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-throttling-response.json" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Update Connection Throttling Configuration Request: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-update-throttling-request.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>Update Connection Throttling Configuration Request: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-update-throttling-request.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        </section>
        <section>
            <title>Protocols</title>
        <section>
            <title>List Load Balancing Protocols</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td>Verb</td>
                        <td>URI</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td>&GET;
                        </td>
                        <td>/loadbalancers/protocols</td>
                        <td>List all supported load balancing protocols.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>
                This operation does not require a request body.
            </para>
            <para>All load balancers must define the protocol of the service which is being load
                    balanced. The protocol selection should be based on the protocol of the back-end
                    nodes. When configuring a load balancer, the default port for the given protocol
                    will be selected unless otherwise specified.</para>
            <example>
                <title>List Load Balancing Protocols Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-protocols-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Load Balancing Protocols Response: JSON</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-protocols-response.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        </section>
        <section>
            <title>Algorithms</title>
            <para>All load balancers utilize an algorithm that defines how traffic should be
                directed between back-end nodes. The default algorithm for newly created load
                balancers is <code>RANDOM</code>, which can be overridden at creation time or
                changed after the load balancer has been initially provisioned. The algorithm name
                is to be constant within a major revision of the load balancing API, though new
                algorithms may be created with a unique algorithm name within a given major revision
                of the service API. It was decided that ROUND-ROBING
                would be the default protocol. If an implementation doesnt support a protocol,
                it should return Invalid value</para>
            <table rules="all">
                <caption>Load Balancing Algorithms</caption>
                <thead>
                    <tr align="center">
                        <td colspan="2">Name</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="2">
                            <code>LEAST_CONNECTIONS</code>
                        </td>
                        <td colspan="3">The node with the lowest number of connections will receive
                            requests.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">
                            <code>RANDOM</code>
                        </td>
                        <td colspan="3">Back-end servers are selected at random.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">
                            <code>ROUND_ROBIN</code>
                        </td>
                        <td colspan="3">Connections are routed to each of the back-end servers in turn. This should
                                        be the default proctocol</td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">
                            <code>WEIGHTED_LEAST_CONNECTIONS</code>
                        </td>
                        <td colspan="3">Each request will be assigned to a node based on the number of
                            concurrent connections to the node and its weight.</td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">
                            <code>WEIGHTED_ROUND_ROBIN</code>
                        </td>
                        <td colspan="3">A round robin algorithm, but with different proportions of traffic
                            being directed to the back-end nodes. Weights must be defined as part of
                            the load balancer's node configuration.
                        </td>
                    </tr>
                </tbody>
            </table>
        <section>
            <title>List Load Balancing Algorithms</title>
            <informaltable rules="all">
                <thead>
                    <tr align="center">
                        <td colspan="1">Verb</td>
                        <td colspan="3">URI</td>
                        <td colspan="3">Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="1">&GET;
                        </td>
                        <td colspan="3">/loadbalancers/algorithms</td>
                        <td colspan="3">List all supported load balancing algorithms.</td>
                    </tr>
                </tbody>
            </informaltable>
            <para>
                Normal Response Code(s):
                <returnvalue>200</returnvalue>
            </para>
            <simpara>Error Response Code(s): loadbalancerFault (<errorcode>400</errorcode>,
                <errorcode>500</errorcode>), serviceUnavailable (<errorcode>503</errorcode>),
                unauthorized (<errorcode>401</errorcode>), badRequest (<errorcode>400</errorcode>),
                overLimit (<errorcode>413</errorcode>)
            </simpara>
            <para>
                This operation does not require a request body.
            </para>
            <example>
                <title>List Load Balancing Algorithms Response: XML</title>
                <programlisting language="xml">
<xi:include href="samples/lb-list-algorithms-response.xml" parse="text"/>
                </programlisting>
            </example>
            <example>
                <title>List Load Balancing Algorithms Response: JSON</title>
                <programlisting language="javascript">
<xi:include href="samples/lb-list-algorithms-response.json" parse="text"/>
                </programlisting>
            </example>
        </section>
        </section>
    </chapter>
    <chapter>
        <title>API Extensions</title>
        <para>Implementations of the API specifications are free to augment with
            extensions as they see appropriate to extend Load Balancing features (e.g. support
            for new LB algorithms) in this API or offer new ones.All client applications written to
            this core specification (using the base API) should work against extended
            implementation as specified in this document. Therefore, applications should not
            receive values not specified in this specification or obtain a different behavior than
            expected when they are not using (or aware of the availability of) extended APIs.
        </para>
        <section>
            <title>Discovering extentions</title>
            <para>
                Implementations should allow users to discover if the LB service supports extensions.
                together with details about the extensions(document pointers, etc.).
            </para>
        </section>
        <section>
            <title>Using extended APIs</title>
            <para>
                Clients should operate on resources using extension URIs in order to make use of the
                extension URI.
            </para>
            <para>
                &POST;
                <code>/loadbalancers/ext/<![CDATA[<ext-name>]]>   </code>
            </para>
            <para>
                The sames load-balancer cand be retrieved using either:
                &GET;
                <code>/loadbalancers/loadBalancerId</code>
                in which case, only the deatures and attributes
                in this document are returned OR GET/loadbalancer/ex/ext-name/loadBalancerId which returns
                the extended version of the loadbalancer (with extra attributes).
            </para>
            <para>
                Clients can always use the core APIs for resources created or updated with extension APIs.
                Extension resources are always defined as pure supersets of core resources. New types of resources can
                be added in the extension API that have no counterpart in the core API. These resouces can be used
                only from the extension API.
            </para>
        </section>
    </chapter>
</book>